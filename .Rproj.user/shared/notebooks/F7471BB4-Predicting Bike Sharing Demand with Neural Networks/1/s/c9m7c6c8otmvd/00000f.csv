"0","library(keras3)"
"0","library(tfruns)"
"0",""
"0","# Define hyperparameter flags"
"0","FLAGS <- flags("
"0","  flag_integer(""nodes1"", 64),"
"0","  flag_integer(""nodes2"", 32),"
"0","  flag_string(""activation"", ""relu""),"
"0","  flag_integer(""batch_size"", 32),"
"0","  flag_numeric(""learning_rate"", 0.001)"
"0",")"
"0",""
"0","# Define the model-building function"
"0","build_model <- function() {"
"0","  model <- keras_model_sequential() %>%"
"0","    layer_dense(units = FLAGS$nodes1, activation = FLAGS$activation, input_shape = ncol(bikes_train_final) - 1) %>%"
"0","    layer_dense(units = FLAGS$nodes2, activation = FLAGS$activation) %>%"
"0","    layer_dense(units = 1)"
"0","  "
"0","  model %>% compile("
"0","    optimizer = optimizer_adam(lr = FLAGS$learning_rate),"
"0","    loss = ""mse"""
"0","  )"
"0","  "
"0","  return(model)"
"0","}"
